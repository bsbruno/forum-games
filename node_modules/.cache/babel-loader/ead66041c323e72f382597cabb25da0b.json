{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/jogos/Desktop/forum-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/jogos/Desktop/forum-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/jogos/Desktop/forum-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useState}from\"react\";import Menu from\"../../components/Menu\";import{useAuth}from\"../../hooks/AuthContext\";import{useRouteMatch}from\"react-router-dom\";import*as S from\"./styled\";import{Container}from\"../../components/Container\";import api from\"../../services/api\";import{useEffect}from\"react\";import CardShowContainer from\"../../components/CardPostShow\";import CardComments from\"../../components/CardComments\";import{FaRegCommentAlt,FaRegSadTear,FaWindowClose}from\"react-icons/fa\";import{Form}from\"@unform/web\";import Button from\"../../components/Button\";import{useRef}from\"react\";import{useHistory}from\"react-router-dom\";import Loading from\"../../components/Loading\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DashBoard=function DashBoard(){var _post$user,_post$user2,_post$user3;var _useRouteMatch=useRouteMatch(),params=_useRouteMatch.params;var _useAuth=useAuth(),userAuth=_useAuth.user;var history=useHistory();var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),comments_text=_useState6[0],setComments_text=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),openModal=_useState8[0],setOpenModal=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loadind=_useState10[0],setLoading=_useState10[1];var formRef=useRef(null);var handleDeletePost=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.next=3;return api.delete(\"post/\".concat(params[\"id\"]));case 3:history.push(\"/home\");setLoading(false);case 5:case\"end\":return _context.stop();}}},_callee);})),[]);var handleSubmit=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return api.post(\"/comments\",{text_comments:comments_text,id_post:post.id});case 2:setComments_text(\"\");setOpenModal(false);case 4:case\"end\":return _context2.stop();}}},_callee2);})),[comments_text,post.id]);useEffect(function(){api.get(\"/post/v1/\".concat(params[\"id\"])).then(function(response){return setPost(response.data);}).catch(function(err){return console.log(err);});},[]);console.log(comments);useEffect(function(){api.get(\"/comments/post_comments/\".concat(params[\"id\"])).then(function(response){return setComments(response.data);}).catch(function(e){return console.log(e);});},[comments_text]);var handleComments=useCallback(function(_ref3){var target=_ref3.target;setComments_text(target.value);},[comments_text]);return/*#__PURE__*/_jsxs(S.Wrapper,{children:[loadind&&/*#__PURE__*/_jsx(S.ModalLoadin,{children:/*#__PURE__*/_jsx(Loading,{})}),/*#__PURE__*/_jsx(Menu,{userName:userAuth.name}),/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(S.Content,{children:[/*#__PURE__*/_jsx(\"div\",{children:post&&/*#__PURE__*/_jsx(CardShowContainer,{text_post:post.post_text,name:(_post$user=post.user)===null||_post$user===void 0?void 0:_post$user.name,nickName:(_post$user2=post.user)===null||_post$user2===void 0?void 0:_post$user2.nickname,profile_image:(_post$user3=post.user)===null||_post$user3===void 0?void 0:_post$user3.avatar_url,deletePost:function deletePost(){return handleDeletePost();},trashVisible:true},post.id)}),/*#__PURE__*/_jsx(S.CommentPostButton,{children:/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(){return setOpenModal(true);},children:[\" \",/*#__PURE__*/_jsx(FaRegCommentAlt,{}),\" \"]})}),/*#__PURE__*/_jsx(\"h1\",{children:\"Comentarios\"}),!comments.length?/*#__PURE__*/_jsxs(S.NotComments,{children:[\" \",/*#__PURE__*/_jsx(FaRegSadTear,{}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Sem Comentarios Ainda \",/*#__PURE__*/_jsx(\"br\",{}),\" seja o Primeiro :)\"]})]}):/*#__PURE__*/_jsx(S.CommentContainer,{children:comments.map(function(intem,index){return/*#__PURE__*/_jsx(CardComments,{text_post:intem.text_comments,profile_image:intem.user.avatar_url,nickName:intem.user.nickname,name:intem.user.name},index);})})]})}),/*#__PURE__*/_jsx(S.CommentModal,{openModal:openModal,children:/*#__PURE__*/_jsxs(S.ModalContent,{comment:comments_text,children:[/*#__PURE__*/_jsxs(S.ProfileContainer,{children:[/*#__PURE__*/_jsx(\"img\",{src:userAuth.avatar_url}),/*#__PURE__*/_jsxs(\"p\",{children:[\" \",userAuth.name,\" \"]})]}),/*#__PURE__*/_jsxs(Form,{ref:formRef,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"textarea\",{name:\"text_comments\",id:\"text_comments\",rows:2,cols:80,maxLength:140,value:comments_text,placeholder:\"Diga o que esta pensando\",onChange:handleComments}),/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\" Comentar\"})]}),/*#__PURE__*/_jsx(S.CloseModal,{onClick:function onClick(){return setOpenModal(false);},children:/*#__PURE__*/_jsx(FaWindowClose,{})})]})})]});};export default DashBoard;","map":{"version":3,"sources":["C:/Users/jogos/Desktop/forum-game/frontend/src/pages/Dashboard/index.tsx"],"names":["React","useCallback","useState","Menu","useAuth","useRouteMatch","S","Container","api","useEffect","CardShowContainer","CardComments","FaRegCommentAlt","FaRegSadTear","FaWindowClose","Form","Button","useRef","useHistory","Loading","DashBoard","params","userAuth","user","history","post","setPost","comments","setComments","comments_text","setComments_text","openModal","setOpenModal","loadind","setLoading","formRef","handleDeletePost","delete","push","handleSubmit","text_comments","id_post","id","get","then","response","data","catch","err","console","log","e","handleComments","target","value","name","post_text","nickname","avatar_url","length","map","intem","index"],"mappings":"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","sourcesContent":["import React, { useCallback, useState } from \"react\";\nimport Menu from \"../../components/Menu\";\nimport { useAuth } from \"../../hooks/AuthContext\";\nimport { useRouteMatch } from \"react-router-dom\";\nimport * as S from \"./styled\";\nimport { Container } from \"../../components/Container\";\nimport api from \"../../services/api\";\nimport { useEffect } from \"react\";\nimport CardShowContainer from \"../../components/CardPostShow\";\nimport CardComments from \"../../components/CardComments\";\nimport { FaRegCommentAlt, FaRegSadTear, FaWindowClose } from \"react-icons/fa\";\nimport { Form } from \"@unform/web\";\nimport Button from \"../../components/Button\";\nimport { FormHandles } from \"@unform/core\";\nimport { useRef } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport Loading from \"../../components/Loading\";\n\ntype PostsProps = {\n  id: string;\n  id_user: string;\n  post_text: string;\n  user: {\n    id: string;\n    avatar_url?: string;\n    name?: string;\n    nickname?: string;\n  };\n};\ntype CommentsProps = {\n  id: string;\n  text_comments: string;\n\n  user: {\n    id: string;\n    avatar_url?: string;\n    name?: string;\n    nickname?: string;\n  };\n};\n\nconst DashBoard: React.FC = () => {\n  const { params } = useRouteMatch();\n  const { user: userAuth } = useAuth();\n  const history = useHistory();\n\n  const [post, setPost] = useState({} as PostsProps);\n  const [comments, setComments] = useState<CommentsProps[]>([]);\n  const [comments_text, setComments_text] = useState(\"\");\n  const [openModal, setOpenModal] = useState(false);\n  const [loadind, setLoading] = useState(false);\n\n  const formRef = useRef<FormHandles>(null);\n\n  const handleDeletePost = useCallback(async () => {\n    setLoading(true);\n    await api.delete(`post/${params[\"id\"]}`);\n    history.push(\"/home\");\n    setLoading(false);\n  }, []);\n\n  const handleSubmit = useCallback(async () => {\n    await api.post(\"/comments\", {\n      text_comments: comments_text,\n      id_post: post.id,\n    });\n    setComments_text(\"\");\n    setOpenModal(false);\n  }, [comments_text, post.id]);\n\n  useEffect(() => {\n    api\n      .get(`/post/v1/${params[\"id\"]}`)\n      .then((response) => setPost(response.data))\n      .catch((err) => console.log(err));\n  }, []);\n  console.log(comments);\n\n  useEffect(() => {\n    api\n      .get(`/comments/post_comments/${params[\"id\"]}`)\n      .then((response) => setComments(response.data))\n      .catch((e) => console.log(e));\n  }, [comments_text]);\n\n  const handleComments = useCallback(\n    ({ target }) => {\n      setComments_text(target.value);\n    },\n    [comments_text]\n  );\n\n  return (\n    <S.Wrapper>\n      {loadind && (\n        <S.ModalLoadin>\n          <Loading />\n        </S.ModalLoadin>\n      )}\n      <Menu userName={userAuth.name} />\n      <Container>\n        <S.Content>\n          <div>\n            {post && (\n              <CardShowContainer\n                key={post.id}\n                text_post={post.post_text}\n                name={post.user?.name}\n                nickName={post.user?.nickname}\n                profile_image={post.user?.avatar_url}\n                deletePost={() => handleDeletePost()}\n                trashVisible={true}\n              />\n            )}\n          </div>\n          <S.CommentPostButton>\n            <button onClick={() => setOpenModal(true)}>\n              {\" \"}\n              <FaRegCommentAlt />{\" \"}\n            </button>\n          </S.CommentPostButton>\n          <h1>Comentarios</h1>\n          {!comments.length ? (\n            <S.NotComments>\n              {\" \"}\n              <FaRegSadTear />\n              <h3>\n                Sem Comentarios Ainda <br /> seja o Primeiro :)\n              </h3>\n            </S.NotComments>\n          ) : (\n            <S.CommentContainer>\n              {comments.map((intem, index) => (\n                <CardComments\n                  key={index}\n                  text_post={intem.text_comments}\n                  profile_image={intem.user.avatar_url}\n                  nickName={intem.user.nickname}\n                  name={intem.user.name}\n                />\n              ))}\n            </S.CommentContainer>\n          )}\n        </S.Content>\n      </Container>\n      <S.CommentModal openModal={openModal}>\n        <S.ModalContent comment={comments_text}>\n          <S.ProfileContainer>\n            <img src={userAuth.avatar_url} />\n            <p> {userAuth.name} </p>\n          </S.ProfileContainer>\n          <Form ref={formRef} onSubmit={handleSubmit}>\n            <textarea\n              name=\"text_comments\"\n              id=\"text_comments\"\n              rows={2}\n              cols={80}\n              maxLength={140}\n              value={comments_text}\n              placeholder=\"Diga o que esta pensando\"\n              onChange={handleComments}\n            ></textarea>\n\n            <Button type=\"submit\"> Comentar</Button>\n          </Form>\n          <S.CloseModal onClick={() => setOpenModal(false)}>\n            <FaWindowClose />\n          </S.CloseModal>\n        </S.ModalContent>\n      </S.CommentModal>\n    </S.Wrapper>\n  );\n};\n\nexport default DashBoard;\n"]},"metadata":{},"sourceType":"module"}