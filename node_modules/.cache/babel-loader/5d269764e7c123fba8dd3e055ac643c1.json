{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/jogos/Desktop/forum-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/jogos/Desktop/forum-game/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";/* eslint-disable @typescript-eslint/ban-types */ /* eslint-disable @typescript-eslint/explicit-module-boundary-types */import React,{useCallback,useRef}from\"react\";import Logo from\"../../components/Logo\";import Button from\"../../components/Button\";import Input from\"../../components/Input\";import{FiLock}from\"react-icons/fi\";import{Form}from\"@unform/web\";import*as S from\"./stlyed\";import*as Yup from\"yup\";import getValidationErros from\"../../utils/getValidationErros\";import{useHistory,useLocation}from\"react-router-dom\";import api from\"../../services/api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ResetPassword=function ResetPassword(){var formRef=useRef(null);var location=useLocation();var history=useHistory();var handleSubmit=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var _formRef$current,schema,password,token,_formRef$current2,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;(_formRef$current=formRef.current)===null||_formRef$current===void 0?void 0:_formRef$current.setErrors({});schema=Yup.object().shape({password:Yup.string().min(6,\"No minimo 6 digitos \"),password_confirmation:Yup.string().oneOf([Yup.ref(\"password\"),null],\"Senhas estão diferente\")});_context.next=5;return schema.validate(data,{abortEarly:false});case 5:password=data.password;token=location.search.replace(\"?token=\",\"\");if(token){_context.next=9;break;}throw new Error();case 9:_context.next=11;return api.post(\"password/reset\",{password:password,token:token});case 11:history.push(\"/home\");_context.next=18;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);if(_context.t0 instanceof Yup.ValidationError){errors=getValidationErros(_context.t0);(_formRef$current2=formRef.current)===null||_formRef$current2===void 0?void 0:_formRef$current2.setErrors(errors);}console.log(_context.t0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[location.search]);return/*#__PURE__*/_jsxs(S.Wrapper,{children:[/*#__PURE__*/_jsx(S.Background,{children:/*#__PURE__*/_jsxs(S.BackgroundText,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Lorem Ipsum\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the \",/*#__PURE__*/_jsx(\"strong\",{children:\"standard dummy text ever\"}),\" since the 1500s, when an unknown printer took a galley of type and scrambled\"]})]})}),/*#__PURE__*/_jsxs(S.Content,{children:[/*#__PURE__*/_jsx(Logo,{size:\"large\",hiddenText:true}),/*#__PURE__*/_jsxs(Form,{ref:formRef,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Altera Senha \"}),/*#__PURE__*/_jsx(Input,{name:\"password\",icon:FiLock,type:\"password\",placeholder:\"Senha\"}),/*#__PURE__*/_jsx(Input,{name:\"password_confirmation\",type:\"password\",placeholder:\"Confirme sua senha\",icon:FiLock}),/*#__PURE__*/_jsx(Button,{color:\"secondary\",type:\"submit\",children:\"Altera Senha\"})]})]})]});};export default ResetPassword;","map":{"version":3,"sources":["C:/Users/jogos/Desktop/forum-game/frontend/src/pages/ResetPassword/index.tsx"],"names":["React","useCallback","useRef","Logo","Button","Input","FiLock","Form","S","Yup","getValidationErros","useHistory","useLocation","api","ResetPassword","formRef","location","history","handleSubmit","data","current","setErrors","schema","object","shape","password","string","min","password_confirmation","oneOf","ref","validate","abortEarly","token","search","replace","Error","post","push","ValidationError","errors","console","log"],"mappings":"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","sourcesContent":["/* eslint-disable @typescript-eslint/ban-types */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nimport React, { useCallback, useRef } from \"react\";\nimport Logo from \"../../components/Logo\";\nimport { FormHandles } from \"@unform/core\";\nimport Button from \"../../components/Button\";\n\nimport Input from \"../../components/Input\";\nimport { FiLock } from \"react-icons/fi\";\nimport { Form } from \"@unform/web\";\nimport * as S from \"./stlyed\";\nimport * as Yup from \"yup\";\nimport getValidationErros from \"../../utils/getValidationErros\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport api from \"../../services/api\";\n\ntype SignUpFormData = {\n  password: string;\n  password_confirmation: string;\n};\n\nconst ResetPassword = () => {\n  const formRef = useRef<FormHandles>(null);\n  const location = useLocation();\n  const history = useHistory();\n\n  const handleSubmit = useCallback(\n    async (data: SignUpFormData) => {\n      try {\n        formRef.current?.setErrors({});\n        const schema = Yup.object().shape({\n          password: Yup.string().min(6, \"No minimo 6 digitos \"),\n          password_confirmation: Yup.string().oneOf(\n            [Yup.ref(\"password\"), null],\n            \"Senhas estão diferente\"\n          ),\n        });\n        await schema.validate(data, {\n          abortEarly: false,\n        });\n\n        const { password } = data;\n        const token = location.search.replace(\"?token=\", \"\");\n\n        if (!token) {\n          throw new Error();\n        }\n\n        await api.post(\"password/reset\", {\n          password,\n          token,\n        });\n        history.push(\"/home\");\n      } catch (err) {\n        if (err instanceof Yup.ValidationError) {\n          const errors = getValidationErros(err);\n          formRef.current?.setErrors(errors);\n        }\n        console.log(err);\n      }\n    },\n    [location.search]\n  );\n\n  return (\n    <S.Wrapper>\n      <S.Background>\n        <S.BackgroundText>\n          <h1>Lorem Ipsum</h1>\n          <p>\n            is simply dummy text of the printing and typesetting industry. Lorem\n            Ipsum has been the <strong>standard dummy text ever</strong> since\n            the 1500s, when an unknown printer took a galley of type and\n            scrambled\n          </p>\n        </S.BackgroundText>\n      </S.Background>\n      <S.Content>\n        <Logo size=\"large\" hiddenText={true} />\n        <Form ref={formRef} onSubmit={handleSubmit}>\n          <h2>Altera Senha </h2>\n\n          <Input\n            name=\"password\"\n            icon={FiLock}\n            type=\"password\"\n            placeholder=\"Senha\"\n          />\n          <Input\n            name=\"password_confirmation\"\n            type=\"password\"\n            placeholder=\"Confirme sua senha\"\n            icon={FiLock}\n          />\n\n          <Button color=\"secondary\" type=\"submit\">\n            Altera Senha\n          </Button>\n        </Form>\n      </S.Content>\n    </S.Wrapper>\n  );\n};\n\nexport default ResetPassword;\n"]},"metadata":{},"sourceType":"module"}